!function(){"use strict";var e,t,n,r,o,i,s,a,u=tinymce.util.Tools.resolve("tinymce.PluginManager"),l=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),f=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),c=tinymce.util.Tools.resolve("tinymce.util.VK"),g=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),p=tinymce.util.Tools.resolve("tinymce.util.Tools"),d=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),m=function(e){return e&&"BR"===e.nodeName},v=function(e){return e&&3===e.nodeType},h=function(e){return e&&/^(OL|UL|DL)$/.test(e.nodeName)},y=function(e){return e&&/^(OL|UL)$/.test(e.nodeName)},N=function(e){return e&&/^(DT|DD)$/.test(e.nodeName)},S=function(e){return e&&/^(TH|TD)$/.test(e.nodeName)},O=m,C=function(e,t){return t&&!!e.schema.getTextBlockElements()[t.nodeName]},b=function(e,t){return e&&e.nodeName in t},E=function(e,t,n){var r=e.isEmpty(t);return!(n&&0<e.select("span[data-mce-type=bookmark]",t).length)&&r},L=function(e,t){return e.isChildOf(t,e.getRoot())},T=function(e,t){if(v(e))return{container:e,offset:t};var n=l.getNode(e,t);return v(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&v(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&v(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}},D=function(e){var t=e.cloneRange(),n=T(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);var r=T(e.endContainer,e.endOffset);return t.setEnd(r.container,r.offset),t},A=d.DOM,k=function(o){var i={},e=function(e){var t,n,r;n=o[e?"startContainer":"endContainer"],r=o[e?"startOffset":"endOffset"],1===n.nodeType&&(t=A.create("span",{"data-mce-type":"bookmark"}),n.hasChildNodes()?(r=Math.min(r,n.childNodes.length-1),e?n.insertBefore(t,n.childNodes[r]):A.insertAfter(t,n.childNodes[r])):n.appendChild(t),n=t,r=0),i[e?"startContainer":"endContainer"]=n,i[e?"startOffset":"endOffset"]=r};return e(!0),o.collapsed||e(),i},w=function(o){function e(e){var t,n,r;t=r=o[e?"startContainer":"endContainer"],n=o[e?"startOffset":"endOffset"],t&&(1===t.nodeType&&(n=function(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t===e)return n;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||n++,t=t.nextSibling}return-1}(t),t=t.parentNode,A.remove(r),!t.hasChildNodes()&&A.isBlock(t)&&t.appendChild(A.create("br"))),o[e?"startContainer":"endContainer"]=t,o[e?"startOffset":"endOffset"]=n)}e(!0),e();var t=A.createRng();return t.setStart(o.startContainer,o.startOffset),o.endContainer&&t.setEnd(o.endContainer,o.endOffset),D(t)},R=function(e){return function(){return e}},I=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!n.apply(null,e)}},x=R(!1),_=R(!0),B=x,P=_,M=function(){return U},U=(r={fold:function(e,t){return e()},is:B,isSome:B,isNone:P,getOr:n=function(e){return e},getOrThunk:t=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:n,orThunk:t,map:M,ap:M,each:function(){},bind:M,flatten:M,exists:B,forall:P,filter:M,equals:e=function(e){return e.isNone()},equals_:e,toArray:function(){return[]},toString:R("none()")},Object.freeze&&Object.freeze(r),r),j=function(n){var e=function(){return n},t=function(){return o},r=function(e){return e(n)},o={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:P,isNone:B,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:t,orThunk:t,map:function(e){return j(e(n))},ap:function(e){return e.fold(M,function(e){return j(e(n))})},each:function(e){e(n)},bind:r,flatten:e,exists:r,forall:r,filter:function(e){return e(n)?o:U},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(B,function(e){return t(n,e)})},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},F={some:j,none:M,from:function(e){return null==e?U:j(e)}},$=function(t){return function(e){return function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t}(e)===t}},q=$("string"),H=$("boolean"),W=$("function"),z=$("number"),K=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},V=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n,e)},X=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},Q=function(e,t,n){return V(e,function(e){n=t(n,e)}),n},Y=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n,e))return F.some(o)}return F.none()},G=Array.prototype.push,J=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!Array.prototype.isPrototypeOf(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);G.apply(t,e[n])}return t}(K(e,t))},Z=Array.prototype.slice,ee=function(e){return 0===e.length?F.none():F.some(e[0])},te=function(e){return 0===e.length?F.none():F.some(e[e.length-1])},ne=(W(Array.from)&&Array.from,"undefined"!=typeof window?window:Function("return this;")()),re=function(e,t){return function(e,t){for(var n=null!=t?t:ne,r=0;r<e.length&&null!=n;++r)n=n[e[r]];return n}(e.split("."),t)},oe=function(e,t){var n=re(e,t);if(null==n)throw e+" not available on this browser";return n},ie=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),se=function(e){var t=e.selection.getStart(!0);return e.dom.getParent(t,"OL,UL,DL",ue(e,t))},ae=function(e){var t,n,r,o=e.selection.getSelectedBlocks();return p.grep((t=e,n=o,r=p.map(n,function(e){return t.dom.getParent(e,"li,dd,dt",ue(t,e))||e}),ie.unique(r)),function(e){return(t=e)&&/^(LI|DT|DD)$/.test(t.nodeName);var t})},ue=function(e,t){var n=e.dom.getParents(t,"TD,TH");return 0<n.length?n[0]:e.getBody()},ce=function(e,t){var n=e.dom.getParents(t,"ol,ul",ue(e,t));return te(n)},le={isList:function(e){var t,n,r=se(e);return(n=re("ownerDocument.defaultView",t=r),oe("HTMLElement",n)).prototype.isPrototypeOf(t)},getParentList:se,getSelectedSubLists:function(e){var t,n,r,o=se(e),i=e.selection.getSelectedBlocks();return r=i,(n=o)&&1===r.length&&r[0]===n?(t=o,p.grep(t.querySelectorAll("ol,ul,dl"),function(e){return h(e)})):p.grep(i,function(e){return h(e)&&o!==e})},getSelectedListItems:ae,getClosestListRootElm:ue,getSelectedDlItems:function(e){return X(ae(e),N)},getSelectedListRoots:function(e){var t,n,r,o,i,s=(n=ce(t=e,t.selection.getStart()),r=X(t.selection.getSelectedBlocks(),y),n.toArray().concat(r));return o=e,i=K(s,function(e){return ce(o,e).getOr(e)}),ie.unique(i)}},fe=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:R(e)}},de=function(e,t){var n=(t||document).createElement(e);return fe(n)},me=fe,ge=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];if(!o.isSome())return F.none();n.push(o.getOrDie())}return F.some(t.apply(null,n))},pe=Object.keys,ve=function(e,t){return n=e,r=t,o=oe("Node").DOCUMENT_POSITION_CONTAINED_BY,0!=(n.compareDocumentPosition(r)&o);var n,r,o},he=function(){return ye(0,0)},ye=function(e,t){return{major:e,minor:t}},Ne=function(e,t){var n=String(t).toLowerCase();return 0===e.length?he():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return ye(r(1),r(2))}(e,n)},Se=he,Oe="Firefox",Ce=function(e,t){return function(){return t===e}},be=function(e){var t=e.current;return{current:t,version:e.version,isEdge:Ce("Edge",t),isChrome:Ce("Chrome",t),isIE:Ce("IE",t),isOpera:Ce("Opera",t),isFirefox:Ce(Oe,t),isSafari:Ce("Safari",t)}},Ee=function(){return be({current:void 0,version:Se()})},Le=be,Te=(R("Edge"),R("Chrome"),R("IE"),R("Opera"),R(Oe),R("Safari"),"Windows"),De="Android",Ae="Solaris",ke="FreeBSD",we=function(e,t){return function(){return t===e}},Re=function(e){var t=e.current;return{current:t,version:e.version,isWindows:we(Te,t),isiOS:we("iOS",t),isAndroid:we(De,t),isOSX:we("OSX",t),isLinux:we("Linux",t),isSolaris:we(Ae,t),isFreeBSD:we(ke,t)}},Ie=function(){return Re({current:void 0,version:Se()})},xe=Re,_e=(R(Te),R("iOS"),R(De),R("Linux"),R("OSX"),R(Ae),R(ke),function(e,t){var n=String(t).toLowerCase();return Y(e,function(e){return e.search(n)})}),Be=function(e,t){return-1!==e.indexOf(t)},Pe=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Me=function(t){return function(e){return Be(e,t)}},Ue=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Be(e,"edge/")&&Be(e,"chrome")&&Be(e,"safari")&&Be(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Pe],search:function(e){return Be(e,"chrome")&&!Be(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Be(e,"msie")||Be(e,"trident")}},{name:"Opera",versionRegexes:[Pe,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Me("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Me("firefox")},{name:"Safari",versionRegexes:[Pe,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Be(e,"safari")||Be(e,"mobile/"))&&Be(e,"applewebkit")}}],je=[{name:"Windows",search:Me("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Be(e,"iphone")||Be(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Me("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Me("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Me("linux"),versionRegexes:[]},{name:"Solaris",search:Me("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Me("freebsd"),versionRegexes:[]}],Fe={browsers:R(Ue),oses:R(je)},$e=function(e){var t,n,r,o,i,s,a,u,c,l,f,d,m,g,p,v=Fe.browsers(),h=Fe.oses(),y=(g=v,p=e,_e(g,p).map(function(e){var t=Ne(e.versionRegexes,p);return{current:e.name,version:t}})).fold(Ee,Le),N=(d=h,m=e,_e(d,m).map(function(e){var t=Ne(e.versionRegexes,m);return{current:e.name,version:t}})).fold(Ie,xe);return{browser:y,os:N,deviceType:(n=y,r=e,o=(t=N).isiOS()&&!0===/ipad/i.test(r),i=t.isiOS()&&!o,s=t.isAndroid()&&3===t.version.major,a=t.isAndroid()&&4===t.version.major,u=o||s||a&&!0===/mobile/i.test(r),c=t.isiOS()||t.isAndroid(),l=c&&!u,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(r),{isiPad:R(o),isiPhone:R(i),isTablet:R(u),isPhone:R(l),isTouch:R(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:R(f)})}},qe={detect:(o=function(){var e=navigator.userAgent;return $e(e)},s=!1,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s||(s=!0,i=o.apply(null,e)),i})},He=(Node.ATTRIBUTE_NODE,Node.CDATA_SECTION_NODE,Node.COMMENT_NODE,Node.DOCUMENT_NODE,Node.DOCUMENT_TYPE_NODE,Node.DOCUMENT_FRAGMENT_NODE,Node.ELEMENT_NODE),We=(Node.TEXT_NODE,Node.PROCESSING_INSTRUCTION_NODE,Node.ENTITY_REFERENCE_NODE,Node.ENTITY_NODE,Node.NOTATION_NODE,He),ze=function(e,t){return e.dom()===t.dom()},Ke=qe.detect().browser.isIE()?function(e,t){return ve(e.dom(),t.dom())}:function(e,t){var n=e.dom(),r=t.dom();return n!==r&&n.contains(r)},Ve=function(e,t){var n=e.dom();if(n.nodeType!==We)return!1;if(void 0!==n.matches)return n.matches(t);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(t);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(t);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Xe=function(e){var t=e.dom();return F.from(t.parentNode).map(me)},Qe=function(e){var t=e.dom();return K(t.childNodes,me)},Ye=function(e,t){var n=e.dom().childNodes;return F.from(n[t]).map(me)},Ge=function(e){return Ye(e,0)},Je=function(e){return Ye(e,e.dom().childNodes.length-1)},Ze=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}("element","offset"),function(t,n){Xe(t).each(function(e){e.dom().insertBefore(n.dom(),t.dom())})}),et=function(e,t){e.dom().appendChild(t.dom())},tt=function(t,e){V(e,function(e){et(t,e)})},nt=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},rt=function(e){return e.dom().nodeName.toLowerCase()},ot=function(e,t){var a=e.dom();!function(e,t){for(var n=pe(e),r=0,o=n.length;r<o;r++){var i=n[r];s=e[i],function(e,t,n){if(!(q(n)||H(n)||z(n)))throw console.error("Invalid call to Attr.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}(a,i,s)}var s}(t)},it=function(e){return Q(e.dom().attributes,function(e,t){return e[t.name]=t.value,e},{})},st=function(e,t,n){if(!q(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);void 0!==e.style&&e.style.setProperty(t,n)},at=function(e){return!0,me(e.dom().cloneNode(!0))},ut=function(e,t){var n,r,o,i=(n=e,r=de(t),o=it(n),ot(r,o),r);Ze(e,i);var s=Qe(e);return tt(i,s),nt(e),i},ct=function(e,t){et(e.item,t.list)},lt=function(e){return Ve(e,"OL,UL")},ft=function(e){return Ge(e).map(lt).getOr(!1)},dt=function(e){return 0<e.depth},mt=function(e){return e.isSelected},gt=Object.prototype.hasOwnProperty,pt=(a=function(e,t){return t},function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<e.length;r++){var o=e[r];for(var i in o)gt.call(o,i)&&(n[i]=a(n[i],o[i]))}return n}),vt=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return vt(n())}}},ht=function(n,r,a,u){return Ge(u).filter(lt).fold(function(){r.each(function(e){ze(e.start,u)&&a.set(!0)});var o,i,s,e=(o=u,i=n,s=a.get(),Xe(o).map(function(e){return{depth:i,isSelected:s,content:(t=o,n=Qe(t),r=Je(t).map(lt).getOr(!1)?n.slice(0,-1):n,K(r,at)),itemAttributes:it(o),listAttributes:it(e),listType:rt(e)};var t,n,r}));r.each(function(e){ze(e.end,u)&&a.set(!1)});var t=Je(u).filter(lt).map(function(e){return yt(n,r,a,e)}).getOr([]);return e.toArray().concat(t)},function(e){return yt(n,r,a,e)})},yt=function(t,n,r,e){return J(Qe(e),function(e){return(lt(e)?yt:ht)(t+1,n,r,e)})},Nt=tinymce.util.Tools.resolve("tinymce.Env"),St=function(e,t){var n,r,o,i,s=e.dom,a=e.schema.getBlockElements(),u=s.createFragment();if(e.settings.forced_root_block&&(o=e.settings.forced_root_block),o&&((r=s.create(o)).tagName===e.settings.forced_root_block&&s.setAttribs(r,e.settings.forced_root_block_attrs),b(t.firstChild,a)||u.appendChild(r)),t)for(;n=t.firstChild;){var c=n.nodeName;i||"SPAN"===c&&"bookmark"===n.getAttribute("data-mce-type")||(i=!0),b(n,a)?(u.appendChild(n),r=null):o?(r||(r=s.create(o),u.appendChild(r)),r.appendChild(n)):u.appendChild(n)}return e.settings.forced_root_block?i||Nt.ie&&!(10<Nt.ie)||r.appendChild(s.create("br",{"data-mce-bogus":"1"})):u.appendChild(s.create("br")),u},Ot=function(e,t){return V(n=t,function(r,e){(function(e,t){for(var n=e[t].depth,r=t-1;0<=r;r--){if(e[r].depth===n)return F.some(e[r]);if(e[r].depth<n)break}return F.none()})(n,e).each(function(e){var t,n;n=e,(t=r).listType=n.listType,t.listAttributes=pt({},n.listAttributes)})}),(a=e.contentDocument,r=t,o=Q(r,function(e,t){return t.depth>e.length?(r=e,function(e){for(var t=1;t<e.length;t++)ct(e[t-1],e[t])}(s=function(e,t,n){for(var r,o,i,s=[],a=0;a<n;a++)s.push((r=e,o=t.listType,i={list:de(o,r),item:de("li",r)},et(i.list,i.item),i));return s}(a,o=t,o.depth-r.length)),function(e,t){for(var n=0;n<e.length-1;n++)r=e[n].item.dom(),st(r,"list-style-type","none");var r;te(e).each(function(e){ot(e.list,t.listAttributes),ot(e.item,t.itemAttributes),tt(e.item,t.content)})}(s,o),i=s,ge([te(r),ee(i)],ct),r.concat(s)):(c=a,l=t,n=e.slice(0,l.depth),te(n).each(function(e){var t,n,r,o,i,s,a,u;t=c,n=l.itemAttributes,r=l.content,o=de("li",t),ot(o,n),tt(o,r),s=o,et((i=e).list,s),i.item=s,u=l,rt((a=e).list)!==u.listType&&(a.list=ut(a.list,u.listType)),ot(a.list,u.listAttributes)}),n);var c,l,n,r,o,i,s},[]),ee(o).map(function(e){return e.list})).toArray();var n,a,r,o},Ct=function(a,e,u){var t,n,r,o,i,s,c,l=(t=e,o=a,c=K(le.getSelectedListItems(o),me),n=ge([Y(c,I(ft)),Y((i=c,s=Z.call(i,0),s.reverse(),s),I(ft))],function(e,t){return{start:e,end:t}}),r=vt(!1),K(t,function(e){return{sourceList:e,entries:yt(0,n,r,e)}}));V(l,function(e){var t,n,r,o,i,s;t=e.entries,n=u,V(X(t,mt),function(e){return function(e,t){switch(n){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}}(0,e)}),r=e.sourceList,i=a,s=e.entries,o=J(function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,s=e.length;i<s;i++){var a=e[i],u=t(a);u!==n&&(r.push(o),o=[]),n=u,o.push(a)}return 0!==o.length&&r.push(o),r}(s,dt),function(e){return ee(e).map(dt).getOr(!1)?Ot(i,e):(o=i,K(e,function(e){var t,n,r=(t=e.content,n=document.createDocumentFragment(),V(t,function(e){n.appendChild(e.dom())}),me(n));return me(St(o,r.dom()))}));var o}),V(o,function(e){Ze(r,e)}),nt(e.sourceList)})},bt=d.DOM,Et=function(e){Ve(e,"DT")&&ut(e,"DD")},Lt=function(r,e,t){V(t,"Indent"===e?Et:function(e){return t=r,void(Ve(n=e,"DD")?ut(n,"DT"):Ve(n,"DT")&&Xe(n).each(function(e){return function(e,t,n){var r,o,i,s,a,u;for(i=bt.select('span[data-mce-type="bookmark"]',t),a=St(e,n),(r=bt.createRng()).setStartAfter(n),r.setEndAfter(t),s=(o=r.extractContents()).firstChild;s;s=s.firstChild)if("LI"===s.nodeName&&e.dom.isEmpty(s)){bt.remove(s);break}e.dom.isEmpty(o)||bt.insertAfter(o,t),bt.insertAfter(a,t),E(e.dom,n.parentNode)&&(u=n.parentNode,p.each(i,function(e){u.parentNode.insertBefore(e,n.parentNode)}),bt.remove(u)),bt.remove(n),E(e.dom,t)&&bt.remove(t)}(t,e.dom(),n.dom())}));var t,n})},Tt=function(e,t){var n=K(le.getSelectedListRoots(e),me),r=K(le.getSelectedDlItems(e),me),o=!1;if(n.length||r.length){var i=e.selection.getBookmark();Ct(e,n,t),Lt(e,t,r),e.selection.moveToBookmark(i),e.selection.setRng(D(e.selection.getRng())),e.nodeChanged(),o=!0}return o},Dt=function(e){return Tt(e,"Indent")},At=function(e){return Tt(e,"Outdent")},kt=function(e){return Tt(e,"Flatten")},wt=function(n,e){p.each(e,function(e,t){n.setAttribute(t,e)})},Rt=function(e,t,n){var r,o,i,s,a,u,c;r=e,o=t,s=(i=n)["list-style-type"]?i["list-style-type"]:null,r.setStyle(o,"list-style-type",s),a=e,wt(u=t,(c=n)["list-attributes"]),p.each(a.select("li",u),function(e){wt(e,c["list-item-attributes"])})},It=function(e,t,n,r){var o,i;for(o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"],1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&O(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(C(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},xt=function(e,t,n){return u=n,(a=t)&&u&&h(a)&&a.nodeName===u.nodeName&&(i=t,s=n,(o=e).getStyle(i,"list-style-type",!0)===o.getStyle(s,"list-style-type",!0))&&(r=n,t.className===r.className);var r,o,i,s,a,u},_t=function(e,t){var n,r;if(n=t.nextSibling,xt(e,t,n)){for(;r=n.firstChild;)t.appendChild(r);e.remove(n)}if(n=t.previousSibling,xt(e,t,n)){for(;r=n.lastChild;)t.insertBefore(r,t.firstChild);e.remove(n)}},Bt=function(e){return"list-style-type"in e},Pt={toggleList:function(e,t,n){var r=le.getParentList(e),o=le.getSelectedSubLists(e);n=n||{},r&&0<o.length?function(t,e,n,r,o){if(e.nodeName!==r||Bt(o)){var i=k(t.selection.getRng(!0));p.each([e].concat(n),function(e){!function(e,t,n,r){if(t.nodeName!==n){var o=e.rename(t,n);Rt(e,o,r)}else Rt(e,t,r)}(t.dom,e,r,o)}),t.selection.setRng(w(i))}else kt(t)}(e,r,o,t,n):function(e,t,n,r){if(t!==e.getBody())if(t)if(t.nodeName!==n||Bt(r)){var o=k(e.selection.getRng(!0));Rt(e.dom,t,r),_t(e.dom,e.dom.rename(t,n)),e.selection.setRng(w(o))}else kt(e);else!function(c,l,f){void 0===f&&(f={});var e,t=c.selection.getRng(!0),d="LI",n=le.getClosestListRootElm(c,c.selection.getStart(!0)),m=c.dom;"false"!==m.getContentEditable(c.selection.getNode())&&("DL"===(l=l.toUpperCase())&&(d="DT"),e=k(t),p.each(function(n,e,r){for(var o,i=[],s=n.dom,t=It(n,e,!0,r),a=It(n,e,!1,r),u=[],c=t;c&&(u.push(c),c!==a);c=c.nextSibling);return p.each(u,function(e){if(C(n,e))return i.push(e),void(o=null);if(s.isBlock(e)||O(e))return O(e)&&s.remove(e),void(o=null);var t=e.nextSibling;g.isBookmarkNode(e)&&(C(n,t)||!t&&e.parentNode===r)?o=null:(o||(o=s.create("p"),e.parentNode.insertBefore(o,e),i.push(o)),o.appendChild(e))}),i}(c,t,n),function(e){var t,n,r,o,i,s,a,u;(n=e.previousSibling)&&h(n)&&n.nodeName===l&&(r=n,o=f,m.getStyle(r,"list-style-type")===(i=null===(i=o?o["list-style-type"]:"")?"":i))?(t=n,e=m.rename(e,d),n.appendChild(e)):(t=m.create(l),e.parentNode.insertBefore(t,e),t.appendChild(e),e=m.rename(e,d)),s=m,a=e,u=["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"],p.each(u,function(e){var t;return s.setStyle(a,((t={})[e]="",t))}),Rt(m,t,f),_t(c.dom,t)}),c.selection.setRng(w(e)))}(e,n,r)}(e,r,t,n)},mergeWithAdjacentLists:_t},Mt=d.DOM,Ut=function(i,e){p.each(p.grep(i.select("ol,ul",e)),function(e){var t,n,r,o;t=i,"LI"===(o=(n=e).parentNode).nodeName&&o.firstChild===n&&((r=o.previousSibling)&&"LI"===r.nodeName?(r.appendChild(n),E(t,o)&&Mt.remove(o)):Mt.setStyle(o,"listStyleType","none")),h(o)&&(r=o.previousSibling)&&"LI"===r.nodeName&&r.appendChild(n)})},jt=function(e,t,n,r){var o,i,s,a,u=t.startContainer,c=t.startOffset;if(3===u.nodeType&&(n?c<u.data.length:0<c))return u;for(o=e.schema.getNonEmptyElements(),1===u.nodeType&&(u=l.getNode(u,c)),i=new f(u,r),n&&(s=e.dom,!!m(a=u)&&!(!s.isBlock(a.nextSibling)||m(a.previousSibling)))&&i.next();u=i[n?"next":"prev2"]();){if("LI"===u.nodeName&&!u.hasChildNodes())return u;if(o[u.nodeName])return u;if(3===u.nodeType&&0<u.data.length)return u}},Ft=function(e,t){var n=t.childNodes;return 1===n.length&&!h(n[0])&&e.isBlock(n[0])},$t=function(t,e,n){var r,o,i=e.parentNode;if(L(t,e)&&L(t,n)){h(n.lastChild)&&(o=n.lastChild),i===n.lastChild&&O(i.previousSibling)&&t.remove(i.previousSibling),(r=n.lastChild)&&O(r)&&e.hasChildNodes()&&t.remove(r),E(t,n,!0)&&t.$(n).empty(),function(e,t,n){var r,o,i,s;if(o=Ft(e,n)?n.firstChild:n,Ft(i=e,s=t)&&i.remove(s.firstChild,!0),!E(e,t,!0))for(;r=t.firstChild;)o.appendChild(r)}(t,e,n),o&&n.appendChild(o);var s=Ke(me(n),me(e))?t.getParents(e,h,n):[];t.remove(e),V(s,function(e){E(t,e)&&e!==t.getRoot()&&t.remove(e)})}},qt=function(e,t){var n,s,r,o=e.dom,i=e.selection,a=i.getStart(),u=le.getClosestListRootElm(e,a),c=o.getParent(i.getStart(),"LI",u);if(c){if((n=c.parentNode)===e.getBody()&&E(o,n))return!0;if(s=D(i.getRng(!0)),(r=o.getParent(jt(e,s,t,u),"LI",u))&&r!==c)return t?function(e,t,n,r){var o,i,s,a=e.dom;if(a.isEmpty(r))i=n,s=r,(o=e).dom.$(s).empty(),$t(o.dom,i,s),o.selection.setCursorLocation(s);else{var u=k(t);$t(a,n,r),e.selection.setRng(w(u))}}(e,s,r,c):function(e,t,n,r){var o=k(s);$t(e.dom,n,r);var i=w(o);e.selection.setRng(i)}(e,0,c,r),!0;if(!r&&!t)return kt(e),!0}return!1},Ht=function(e,t){return e.selection.isCollapsed()?qt(n=e,r=t)||function(o,i){var s=o.dom,e=o.selection.getStart(),a=le.getClosestListRootElm(o,e),u=s.getParent(e,s.isBlock,a);if(u&&s.isEmpty(u)){var t=D(o.selection.getRng(!0)),c=s.getParent(jt(o,t,i,a),"LI",a);if(c)return o.undoManager.transact(function(){var e,t,n,r;t=u,n=a,r=(e=s).getParent(t.parentNode,e.isBlock,n),e.remove(t),r&&e.isEmpty(r)&&e.remove(r),Pt.mergeWithAdjacentLists(s,c.parentNode),o.selection.select(c,!0),o.selection.collapse(i)}),!0}return!1}(n,r):(i=(o=e).selection.getStart(),s=le.getClosestListRootElm(o,i),!!(o.dom.getParent(i,"LI,DT,DD",s)||0<le.getSelectedListItems(o).length)&&(o.undoManager.transact(function(){o.execCommand("Delete"),Ut(o.dom,o.getBody())}),!0));var n,r,o,i,s},Wt=Ht,zt=function(t,n){return function(){var e=t.dom.getParent(t.selection.getStart(),"UL,OL,DL");return e&&e.nodeName===n}},Kt=function(e){var t,n;e.getParam("lists_indent_on_tab",!0)&&(t=e).on("keydown",function(e){e.keyCode!==c.TAB||c.metaKeyPressed(e)||t.undoManager.transact(function(){(e.shiftKey?At(t):Dt(t))&&e.preventDefault()})}),(n=e).on("keydown",function(e){e.keyCode===c.BACKSPACE?Ht(n,!1)&&e.preventDefault():e.keyCode===c.DELETE&&Ht(n,!0)&&e.preventDefault()})},Vt=function(t,i){return function(e){var o=e.control;t.on("NodeChange",function(e){var t=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}(e.parents,S),n=-1!==t?e.parents.slice(0,t):e.parents,r=p.grep(n,h);o.active(0<r.length&&r[0].nodeName===i)})}};u.add("lists",function(e){return Kt(e),i=(o=r=e).settings.plugins?o.settings.plugins:"",-1===p.inArray(i.split(/[ ,]/),"advlist")&&(r.addButton("numlist",{active:!1,title:"Numbered list",cmd:"InsertOrderedList",onPostRender:Vt(r,"OL")}),r.addButton("bullist",{active:!1,title:"Bullet list",cmd:"InsertUnorderedList",onPostRender:Vt(r,"UL")})),r.addButton("indent",{icon:"indent",title:"Increase indent",cmd:"Indent"}),(n=e).on("BeforeExecCommand",function(e){var t=e.command.toLowerCase();"indent"===t?Dt(n):"outdent"===t&&At(n)}),n.addCommand("InsertUnorderedList",function(e,t){Pt.toggleList(n,"UL",t)}),n.addCommand("InsertOrderedList",function(e,t){Pt.toggleList(n,"OL",t)}),n.addCommand("InsertDefinitionList",function(e,t){Pt.toggleList(n,"DL",t)}),n.addCommand("RemoveList",function(){kt(n)}),n.addQueryStateHandler("InsertUnorderedList",zt(n,"UL")),n.addQueryStateHandler("InsertOrderedList",zt(n,"OL")),n.addQueryStateHandler("InsertDefinitionList",zt(n,"DL")),t=e,{backspaceDelete:function(e){Wt(t,e)}};var t,n,r,o,i})}();