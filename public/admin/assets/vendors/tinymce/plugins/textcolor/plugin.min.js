!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),f=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),m=tinymce.util.Tools.resolve("tinymce.util.Tools"),e=["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"],l=function(t){return t.getParam("textcolor_map",e)},c=function(t){return t.getParam("textcolor_rows",5)},o=function(t){return t.getParam("textcolor_cols",8)},i=function(t){return t.getParam("color_picker_callback",null)},u=function(t){return t.getParam("forecolor_cols",o(t))},s=function(t){return t.getParam("backcolor_cols",o(t))},d=i,F=tinymce.util.Tools.resolve("tinymce.util.I18n"),g=function(t,e){t.style.background=e,t.setAttribute("data-mce-color",e)},r=function(o){return function(t){var e=t.control;e._color?o.execCommand("mceApplyTextcolor",e.settings.format,e._color):o.execCommand("mceRemoveTextcolor",e.settings.format)}},a=function(i,u){return function(t){var e,o,r,a,n=this.parent(),l=(o=i,r=n.settings.format,o.dom.getParents(o.selection.getStart(),function(t){var e;(e=t.style["forecolor"===r?"color":"background-color"])&&(a=a||e)}),a),c=function(t){i.execCommand("mceApplyTextcolor",n.settings.format,t),n.hidePanel(),n.color(t)};f.DOM.getParent(t.target,".mce-custom-color-btn")&&(n.hidePanel(),d(i).call(i,function(t){var e,o,r,a=n.panel.getEl().getElementsByTagName("table")[0];for(e=m.map(a.rows[a.rows.length-1].childNodes,function(t){return t.firstChild}),r=0;r<e.length&&(o=e[r]).getAttribute("data-mce-color");r++);if(r===u)for(r=0;r<u-1;r++)g(e[r],e[r+1].getAttribute("data-mce-color"));g(o,t),c(t)},l)),(e=t.target.getAttribute("data-mce-color"))?(this.lastId&&f.DOM.get(this.lastId).setAttribute("aria-selected","false"),t.target.setAttribute("aria-selected",!0),this.lastId=t.target.id,"transparent"===e?(i.execCommand("mceRemoveTextcolor",n.settings.format),n.hidePanel(),n.resetColor()):c(e)):null!==e&&n.hidePanel()}},b=function(a,n){return function(){var t,e,o,r;return function(t,e,o,r){var a,n,l,c,i,u,m,s=0,d=f.DOM.uniqueId("mcearia"),g=function(t,e){var o="transparent"===t;return'<td class="mce-grid-cell'+(o?" mce-colorbtn-trans":"")+'"><div id="'+d+"-"+s+++'" data-mce-color="'+(t||"")+'" role="option" tabIndex="-1" style="'+(t?"background-color: "+t:"")+'" title="'+F.translate(e)+'">'+(o?"&#215;":"")+"</div></td>"};for((a=function(t){var e,o=[];for(e=0;e<t.length;e+=2)o.push({text:t[e+1],color:"#"+t[e]});return o}(o)).push({text:F.translate("No color"),color:"transparent"}),l='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>',c=a.length-1,u=0;u<e;u++){for(l+="<tr>",i=0;i<t;i++)l+=c<(m=u*t+i)?"<td></td>":g((n=a[m]).color,n.text);l+="</tr>"}if(r){for(l+='<tr><td colspan="'+t+'" class="mce-custom-color-btn"><div id="'+d+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+d+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+F.translate("Custom...")+"</button></div></td></tr>",l+="<tr>",i=0;i<t;i++)l+=g("","Custom color");l+="</tr>"}return l+"</tbody></table>"}(n?u(a):s(a),n?(r=a).getParam("forecolor_rows",c(r)):(o=a).getParam("backcolor_rows",c(o)),n?(e=a).getParam("forecolor_map",l(e)):(t=a).getParam("backcolor_map",l(t)),"function"==typeof i(a))}};t.add("textcolor",function(t){var e,n;(n=t).addCommand("mceApplyTextcolor",function(t,e){var o,r,a;r=t,a=e,(o=n).undoManager.transact(function(){o.focus(),o.formatter.apply(r,{value:a}),o.nodeChanged()})}),n.addCommand("mceRemoveTextcolor",function(t){var e,o;o=t,(e=n).undoManager.transact(function(){e.focus(),e.formatter.remove(o,{value:null},null,!0),e.nodeChanged()})}),(e=t).addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:!0,html:b(e,!0),onclick:a(e,u(e))},onclick:r(e)}),e.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:!0,html:b(e,!1),onclick:a(e,s(e))},onclick:r(e)})})}();