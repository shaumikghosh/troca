!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.Env"),i=function(){return'<img src="'+a.transparentSrc+'" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />'},g=i,m=function(){return"mce-pagebreak"};e.add("pagebreak",function(e){var a,c,o,t,n,r;(r=e).addCommand("mcePageBreak",function(){r.settings.pagebreak_split_block?r.insertContent("<p>"+g()+"</p>"):r.insertContent(g())}),(n=e).addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),n.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"}),o=(c=e).getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e"),t=new RegExp(o.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi"),c.on("BeforeSetContent",function(e){e.content=e.content.replace(t,i())}),c.on("PreInit",function(){c.serializer.addNodeFilter("img",function(e){for(var a,t,n=e.length;n--;)if((t=(a=e[n]).attr("class"))&&-1!==t.indexOf("mce-pagebreak")){var r=a.parent;if(c.schema.getBlockElements()[r.name]&&c.getParam("pagebreak_split_block",!1)){r.type=3,r.value=o,r.raw=!0,a.remove();continue}a.type=3,a.value=o,a.raw=!0}})}),(a=e).on("ResolveName",function(e){"IMG"===e.target.nodeName&&a.dom.hasClass(e.target,m())&&(e.name="pagebreak")})})}();